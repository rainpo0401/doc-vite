import{_ as e,c as a,o as s,a4 as n}from"./chunks/framework.DpC1ZpOZ.js";const _=JSON.parse('{"title":"ACN_SparseCtrlRGBPreprocessor","description":"","frontmatter":{},"headers":[],"relativePath":"comfyui/ACN/ACN_SparseCtrlRGBPreprocessor.md","filePath":"comfyui/ACN/ACN_SparseCtrlRGBPreprocessor.md"}'),p={name:"comfyui/ACN/ACN_SparseCtrlRGBPreprocessor.md"},r=n(`<h1 id="acn-sparsectrlrgbpreprocessor" tabindex="-1">ACN_SparseCtrlRGBPreprocessor <a class="header-anchor" href="#acn-sparsectrlrgbpreprocessor" aria-label="Permalink to &quot;ACN_SparseCtrlRGBPreprocessor&quot;">â€‹</a></h1><ul><li>Class name: RgbSparseCtrlPreprocessor</li><li>Category: Adv-ControlNet ğŸ›‚ğŸ…ğŸ…’ğŸ…/SparseCtrl/preprocess</li><li>Output node: False</li><li>Repo Ref: <a href="https://github.com/Kosinkadink/ComfyUI-Advanced-ControlNet.git" target="_blank" rel="noreferrer">https://github.com/Kosinkadink/ComfyUI-Advanced-ControlNet.git</a></li></ul><p>RgbSparseCtrlPreprocessorèŠ‚ç‚¹æ—¨åœ¨ä¸ºæ¶‰åŠç¨€ç–æ§åˆ¶æœºåˆ¶çš„é«˜çº§æ§åˆ¶ç½‘ç»œå¤„ç†å‡†å¤‡å›¾åƒæ•°æ®ã€‚å®ƒå°†è¾“å…¥å›¾åƒæ”¾å¤§ä»¥åŒ¹é…æ½œåœ¨å¤§å°ï¼Œå°†å›¾åƒç¼–ç ä¸ºæ½œåœ¨ç©ºé—´è¡¨ç¤ºï¼Œå¹¶ä»¥ç‰¹å®šäºä¸‹æ¸¸æ§åˆ¶ç½‘ç»œåº”ç”¨çš„é¢„å¤„ç†æ ¼å¼åŒ…è£…ç¼–ç æ•°æ®ã€‚</p><h1 id="input-types" tabindex="-1">Input types <a class="header-anchor" href="#input-types" aria-label="Permalink to &quot;Input types&quot;">â€‹</a></h1><h2 id="required" tabindex="-1">Required <a class="header-anchor" href="#required" aria-label="Permalink to &quot;Required&quot;">â€‹</a></h2><ul><li>image <ul><li>å›¾åƒå‚æ•°å¯¹äºé¢„å¤„ç†é˜¶æ®µè‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»£è¡¨äº†å°†è¢«æ”¾å¤§å’Œç¼–ç çš„åŸå§‹è¾“å…¥ã€‚å®ƒæ˜¯å½±å“èŠ‚ç‚¹è¾“å‡ºå’Œæ§åˆ¶ç½‘ç»œä¸­åç»­å¤„ç†çš„åŸºæœ¬å…ƒç´ ã€‚</li><li>Comfy dtype: IMAGE</li><li>Python dtype: torch.Tensor</li></ul></li><li>vae <ul><li>vaeå‚æ•°æŒ‡å®šäº†å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVAEï¼‰æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å°†ç”¨äºå°†å›¾åƒç¼–ç ä¸ºæ½œåœ¨è¡¨ç¤ºã€‚è¿™ä¸ªæ¨¡å‹å¯¹äºèŠ‚ç‚¹å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºé€‚åˆé«˜çº§æ§åˆ¶ç½‘ç»œæ“ä½œçš„æ ¼å¼è‡³å…³é‡è¦ã€‚</li><li>Comfy dtype: VAE</li><li>Python dtype: comfy.sd.VAE</li></ul></li><li>latent_size <ul><li>latent_sizeå‚æ•°å®šä¹‰äº†å›¾åƒå°†è¢«ç¼–ç çš„æ½œåœ¨ç©ºé—´çš„ç»´åº¦ã€‚å®ƒæ˜¯èŠ‚ç‚¹è¾“å‡ºè´¨é‡çš„å…³é”®å†³å®šå› ç´ ï¼Œä»¥åŠç¼–ç æ•°æ®åœ¨æ§åˆ¶ç½‘ç»œæ¡†æ¶å†…çš„åç»­é€‚ç”¨æ€§ã€‚</li><li>Comfy dtype: LATENT</li><li>Python dtype: Dict[str, torch.Tensor]</li></ul></li></ul><h1 id="output-types" tabindex="-1">Output types <a class="header-anchor" href="#output-types" aria-label="Permalink to &quot;Output types&quot;">â€‹</a></h1><ul><li>proc_IMAGE <ul><li>proc_IMAGEè¾“å‡ºæ˜¯è¾“å…¥å›¾åƒçš„é¢„å¤„ç†ç‰ˆæœ¬ï¼Œç¼–ç ä¸ºæ½œåœ¨ç©ºé—´è¡¨ç¤ºã€‚æ­¤è¾“å‡ºä¸“é—¨è®¾è®¡ä¸ºä¸é«˜çº§æ§åˆ¶ç½‘ç»œèŠ‚ç‚¹å…¼å®¹ï¼Œä¸æ‰“ç®—ç”¨äºå…¶ä»–ç±»å‹çš„å›¾åƒè¾“å…¥ã€‚</li><li>Comfy dtype: IMAGE</li><li>Python dtype: PreprocSparseRGBWrapper</li></ul></li></ul><h1 id="usage-tips" tabindex="-1">Usage tips <a class="header-anchor" href="#usage-tips" aria-label="Permalink to &quot;Usage tips&quot;">â€‹</a></h1><ul><li>Infra type: GPU</li></ul><h1 id="source-code" tabindex="-1">Source code <a class="header-anchor" href="#source-code" aria-label="Permalink to &quot;Source code&quot;">â€‹</a></h1><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>class RgbSparseCtrlPreprocessor:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @classmethod</span></span>
<span class="line"><span>    def INPUT_TYPES(s):</span></span>
<span class="line"><span>        return {&#39;required&#39;: {&#39;image&#39;: (&#39;IMAGE&#39;,), &#39;vae&#39;: (&#39;VAE&#39;,), &#39;latent_size&#39;: (&#39;LATENT&#39;,)}}</span></span>
<span class="line"><span>    RETURN_TYPES = (&#39;IMAGE&#39;,)</span></span>
<span class="line"><span>    RETURN_NAMES = (&#39;proc_IMAGE&#39;,)</span></span>
<span class="line"><span>    FUNCTION = &#39;preprocess_images&#39;</span></span>
<span class="line"><span>    CATEGORY = &#39;Adv-ControlNet ğŸ›‚ğŸ…ğŸ…’ğŸ…/SparseCtrl/preprocess&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    def preprocess_images(self, vae: VAE, image: Tensor, latent_size: Tensor):</span></span>
<span class="line"><span>        image = image.movedim(-1, 1)</span></span>
<span class="line"><span>        image = comfy.utils.common_upscale(image, latent_size[&#39;samples&#39;].shape[3] * 8, latent_size[&#39;samples&#39;].shape[2] * 8, &#39;nearest-exact&#39;, &#39;center&#39;)</span></span>
<span class="line"><span>        image = image.movedim(1, -1)</span></span>
<span class="line"><span>        try:</span></span>
<span class="line"><span>            image = vae.vae_encode_crop_pixels(image)</span></span>
<span class="line"><span>        except Exception:</span></span>
<span class="line"><span>            image = VAEEncode.vae_encode_crop_pixels(image)</span></span>
<span class="line"><span>        encoded = vae.encode(image[:, :, :, :3])</span></span>
<span class="line"><span>        return (PreprocSparseRGBWrapper(condhint=encoded),)</span></span></code></pre></div>`,12),l=[r];function t(i,o,c,d,u,h){return s(),a("div",null,l)}const C=e(p,[["render",t]]);export{_ as __pageData,C as default};
